# 需求与设计文档

## 1 功能需求

### 1.1 系统角色

+ 普通用户：正常注册的用户
+ 会员用户：选择成为会员的用户
+ 管理员：能够对信息进行编辑的人，可以对数据库进行操作

### 1.2 用户故事

1. 普通用户

    + <普通用户><点击注册><以注册账号>
    + <普通用户><点击登录><以登录已有账号>
    + <普通用户><点击聊天><以进入聊天列表>
    + <普通用户><点击列表中的某一项><以进入对应聊天框>
    + <普通用户><点击聊天框右上角…><以对聊天内容进行设置>
    + <普通用户><点击聊天框左上角←><以返回聊天列表>
    + <普通用户><点击聊天框联系人头像><以对联系人进行设置>
    + <普通用户><点击列表右上方🔍><以搜索联系人和聊天内容>
    + <普通用户><点击列表右上方➕><以创建聊天或群聊>
    + <普通用户><点击附近><以进入附近的人>
    + <普通用户><点击附近上方附近动态><以进入附近动态>
    + <普通用户><点击附近上方附近的人><以回到附近的人>
    + <普通用户><点击陌生人的❤️><以表示喜欢>
    + <普通用户><点击陌生人的头像><以查看其更多信息>
    + <普通用户><点击附近动态中的点赞><以点赞>
    + <普通用户><点击附近动态中的评论><以评论>
    + <普通用户><点击动态><以进入动态>
    + <普通用户><点击动态中的评论><以评论>
    + <普通用户><点击动态中的点赞><以点赞>
    + <普通用户><点击动态中的收藏><以收藏>
    + <普通用户><点击动态右上角✏️><以发布动态>
    + <普通用户><点击发布动态中的发布><以确认发布>
    + <普通用户><点击发布动态中的各个信息：图片、地点、可见人><以编辑信息>
    + <普通用户><点击发布动态中的返回><以返回动态列表且自动保存草稿>
    + <普通用户><点击通讯录><以进入通讯录>
    + <普通用户><点击通讯录上新的朋友><以查看被陌生人喜欢和新的好友>
    + <普通用户><点击通讯录特别关心><以查看特别关心好友>
    + <普通用户><点击通讯录联系人某一项或头像><以对联系人进行设置>
    + <普通用户><点击通讯录右上角🔍><以查找已有的联系人>
    + <普通用户><点击通讯录右上角➕><以添加新联系人>
    + <普通用户><长按分组名称><以编辑组名>
    + <普通用户><长按通讯录联系人右侧🌟><以设置为特别关心>
    + <普通用户><点击我的><以进入我的>
    + <普通用户><点击头像旁箭头><以进入个人信息编辑>
    + <普通用户><点击个人信息的头像><以更换头像>
    + <普通用户><点击个人信息其他内容><以编辑>
    + <普通用户><点击个人信息页保存><以保存更改>
    + <普通用户><点击返回><以返回我的页面>
    + <普通用户><点击我的相册><以编辑照片墙>
    + <普通用户><点击通用><以设置通用信息>
    + <普通用户><点击隐私><以设置隐私信息>
    + <普通用户><点击设置><以进行软件设置和版本查看>
    + <普通用户><点击二维码><以生成个人二维码用于好友添加>
    + <普通用户><点击退出登录><以退出登录当前账号>

2. 会员用户（更多功能待定）

    + <会员用户><点击陌生人的照片墙><以查看具体照片> 

### 1.3 功能点清单

1. 用户与联系人

    + 用户注册登录、修改密码
    + 用户修改 ID、个人信息、头像
    + 用户查找、添加、删除联系人
    + 用户可以编辑自己的爱好、所在地等信息
    + <mark>用户可以自己配置自己的照片墙</mark>
    + <mark>用户可以选择是否成为会员用户（条件待定）</mark>
    + <mark>可以搜索联系人</mark>

2. 聊天与会话

    + 向联系人发起聊天
    + 向通信对象实时推送消息并以通知形式提醒
    + 聊天消息在云端进行存储同步，可以在线查看、删除历史消息
    + 会话中发送、接收文字
    + 会话中发送、接收、展示图片(包括调用相机进行拍照)
    + 会话中发送、接收、播放音频(包括调用麦克风进行录音)
    + 会话中发送、接收、播放视频(包括调用相机进行录像)
    + 会话中发送、接收并展示地理位置信息(可以调用外部地图软件)
    + <mark>可以向陌生人发起聊天</mark>
    + <mark>接到陌生人的聊天可以选择查看与否</mark>
    + <mark>可以搜索聊天内容</mark>

3. 群聊与管理

    + 指定若干位联系人，发起群聊
    + 查看群聊成员
    + 群成员可以邀请联系人加入群聊或者主动退出群聊
    + <mark>在群聊中适当添加一些活动可供选择</mark>

4. 动态发布

    + 按时间线浏览所有联系人发布的动态
    + 发布图文动态
    + 发布视频动态
    + 对联系人及自己发布的动态进行点赞、展示单条动态的所有的点赞人信息
    + 对联系人及自己发布的动态进行文字回复、展示所有的回复信息
    + <mark>动态发布可以选择是否陌生人可见</mark>

5. <mark>附近的人</mark>

    + <mark>可以按距离远近浏览所有附近陌生人</mark>
    + <mark>可以按在线与否浏览所有附近陌生人</mark>
    + <mark>可以按发布时间和距离的混合计算选取关联大的进行陌生人的动态展示</mark>

6. <mark>圈子功能（待定）</mark>

## 2 非功能需求

### 2.1 性能

1. 响应时间

    + 切换页面响应时间不得超过300ms
    + 登录响应时间在1s以内
    + 刷新列表响应时间在1.5s以内
    + 搜索功能可以在2s之内得到结果
    + 调用外部应用响应时间不得超过2s
    + 此外，一般功能的响应时间几乎没有延时

2. 业务量

    + 估计用户数为2w人，每天登录用户数在5k左右
    + 系统至少同时满足1w个用户的请求和提供浏览功能

### 2.2 安全性

+ 严格控制权限访问，不同用户具有不同的身份和权限，保证数据不被越权访问和修改
+ 提供日志管理功能
+ 能经受来自互联网的常见的攻击
+ 用户密码通过加密保存

### 2.3 数据的备份和恢复

+ 系统每隔一周备份一次
+ <mark>对于部分数据只可以进行增加不可删除，但不给用户显示</mark>
+ <mark>对于部分数据，要做脱敏处理</mark>

## 3 初步设计

### 3.1 原型图

1. 聊天

    <img src="chat.jpg" width="20%" alt="图1 聊天">

2. 附近

    <img src="nearby.jpg" width="20%" alt="图2 附近">

3. 动态

    <img src="trend.jpg" width="20%" alt="图3 动态">

4. 通讯录

    <img src="contact.jpg" width="10%" alt="图4 通讯录">

5. 我的

    <img src="myinfo.jpg" width="20%" alt="图5 我的">

### 3.2 技术规格

+ 前端使用Java，后端使用助教的框架
+ 『聊天』：webSocket
+ 『附近的人』：调用GPS定位